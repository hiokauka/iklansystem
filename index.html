<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AdSpace</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

    <style>
     body {
    font-family: "Montserrat", sans-serif;
    font-size: 18px;
    background: #e5e1e1;
    color: #222;
    margin: 0;
    padding: 0;
}

.main-content-home {
    flex: 1; /* Pushes footer to bottom */
}

header {
    background: #1a093c;
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    padding: 10px 15px;
}

footer {
    background: #ffffff;
}

.title {
    font-weight: 700;
    font-size: 2.2rem;
    color: #ffffff;
    margin-top: 15px;
    margin-left: 450px; /* Will adjust in mobile */
}

/* Sidebar */
.sidebar {
    width: 260px;
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    background: white;
    padding: 1.5rem;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
    display: none;
    z-index: 1050;
    overflow-y: auto;
}

nav a {
    font-size: 20px;
    padding: 10px 0;
    display: block;
}

/* Cards */
.card {
    border-radius: 12px;
}

.card-body h5 {
    font-size: 1.4rem;
}

.btn {
    font-size: 18px;
    padding: 10px 16px; /* Larger tap area */
}

.footer-text {
    font-size: 17px;
}

/* Button row */
.button-group {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    margin-top: auto;
    color: #001f4e;
}

.btn-details {
    background-color: #001638;
    color: white;
    border: none;
    border-radius: 5px;
    padding: 10px 15px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

button:focus,
a:focus {
    outline: 3px solid #0d6efd55;
}

.ad-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
}

.ad-card {
    transition: all 0.3s ease;
    border: #001638 solid 1px;
}

.btn-navbar {
    font-size: 24px;
    background: none;
    border: white solid 2px;
    border-radius: 8px;
    cursor: pointer;
    color: white;
}

.card-img-top {
    width: 100%;       /* full width of the card */
    height: 200px;     /* fixed height */
    object-fit: cover; /* maintain aspect ratio, crop if needed */
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
}

/* ===== Responsive adjustments ===== */
@media (max-width: 1024px) {
    .title {
        font-size: 2rem;
        margin-left: auto;
        margin-right: auto;
        text-align: center;
    }

    .btn-navbar {
        font-size: 22px;
    }
}

@media (max-width: 768px) {
    .title {
        font-size: 1.8rem;
    }

    .btn {
        font-size: 16px;
        padding: 8px 12px;
    }

    .btn-details {
        font-size: 14px;
        padding: 8px 12px;
    }

    .card-body h5 {
        font-size: 1.2rem;
    }
}

@media (max-width: 480px) {
    .title {
        font-size: 1.5rem;
    }

    .btn {
        font-size: 14px;
        padding: 6px 10px;
    }

    .btn-details {
        font-size: 13px;
        padding: 6px 10px;
    }

    nav a {
        font-size: 16px;
    }
}

    </style>
</head>

<body class=" min-vh-100 d-flex flex-column">
    <!-- Header -->
    <header class="mb-4 p-3 shadow-sm d-flex flex-column flex-md-row">

        <button class="btn-navbar mt-3" id="toggleSidebar">☰</button>
        <h1 class="  title "> HUB PENGIKLANAN DIGITAL</h1>

    </header>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <button class="btn-close mb-3" id="closeSidebar"></button>
        <nav class="d-flex flex-column my-4">
            <a href="/" class="mb-2 text-decoration-none text-dark">Laman Utama</a>

            <a href="/Contact.html" class="mb-2 text-decoration-none text-dark">Hubungi Kami</a>

            <a href="/login.html" class="mb-2 text-decoration-none" style="color: green;">Log Masuk</a>

        </nav>
    </div>


    <div class=" main-content-home">
        <!-- Main Content -->

        <!-- Ads Container -->
        <div class="container my-4">
            <div class="row g-4" id="adsContainer">
                <!-- Ads will be dynamically inserted here -->
            </div>
        </div>


    </div>
    <!-- Ad Modal -->
    <div class="modal fade" id="adModal1" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalAdTitle">Title</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <img id="modalAdImage" src="/assets/images/image.png" alt="Ad Image"
                        class="img-fluid rounded mb-3" />
                    <p class="text-primary fw-bold" id="modalAdPrice">RM0</p>
                    <p id="modalAdDescription">Description</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="adModal2" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ad Title 2</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <img src="https://via.placeholder.com/400x250" alt="Ad 2" class="img-fluid rounded mb-3" />
                    <p class="text-primary fw-bold">$70</p>
                    <p>Description for Ad 2 goes here.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="mt-5 text-center text-muted py-2">
        © 2025 AdSpace. All rights reserved.
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Sidebar Toggle Script -->
    <script>
        const toggleBtn = document.getElementById('toggleSidebar');
        const closeBtn = document.getElementById('closeSidebar');
        const sidebar = document.getElementById('sidebar');

        toggleBtn.addEventListener('click', () => {
            sidebar.style.display = 'block';
        });
        closeBtn.addEventListener('click', () => {
            sidebar.style.display = 'none';
        });
    </script>

    <script type="module">

        console.log("Ads script loaded");
        import { supabase } from '/supabase.js';

        async function loadAds() {
            const container = document.getElementById("adsContainer");
            console.log("adsContainer:", container);

            // Fetch all ads
            const { data: ads, error } = await supabase
                .from("adverts")
                .select("*")
                .order("created_at", { ascending: false });

            console.log("Fetched ads:", ads, error);

            if (error) {
                console.error("Error fetching ads:", error);
                return;
            }

            container.innerHTML = "";

            ads.forEach(ad => {
                const card = `
        <div class="col-12 col-sm-6 col-md-4 col-lg-3">
            <div class="card h-100 ad-card shadow-sm">
                <img src="${ad.image_url || '/assets/images/image.png'}" class="card-img-top" alt="${ad.title}" />
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">${ad.title}</h5>
                    <p class="text-primary fw-bold">RM ${ad.price}</p>
                    <div class="button-group">
                        <button class="btn btn-primary mt-auto" 
                                data-bs-toggle="modal" 
                                data-bs-target="#adModal1"
                                data-title="${ad.title}"
                                data-description="${ad.description}"
                                data-price="${ad.price}"
                                data-image="${ad.image_url}">
                            Lihat Butiran
                        </button>
                    </div>
                </div>
            </div>
        </div>
        `;
                container.innerHTML += card;
            });

            attachModalEvents();
        }

        // Attach modal population events
        function attachModalEvents() {
            document.querySelectorAll("#adsContainer .btn").forEach(btn => {
                btn.addEventListener("click", e => {
                    const button = e.currentTarget;
                    const title = button.dataset.title;
                    const description = button.dataset.description;
                    const price = button.dataset.price;
                    const image = button.dataset.image;

                    document.getElementById("modalAdTitle").innerText = title;
                    document.getElementById("modalAdDescription").innerText = description;
                    document.getElementById("modalAdPrice").innerText = "RM " + price;
                    document.getElementById("modalAdImage").src = image || "/assets/images/image.png";
                });
            });
        }

        // Load ads on page load
        loadAds();
    </script>
</body>

</html>